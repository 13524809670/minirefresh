/**
 * minirefresh - 一款极简的H5下拉刷新
 * @version v1.0.0
 * @author dailc
 * https://github.com/dailc/minirefresh
 */
window.MiniRefreshTools=window.MiniRefreshTools||function(o){return function(){var t=!1,i=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,n=function(){};n.extend=function(o){function n(){!t&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;t=!0;var s=new this;t=!1;for(var r in o)s[r]="function"==typeof o[r]&&"function"==typeof e[r]&&i.test(o[r])?function(o,t){return function(){var i=this._super;this._super=e[o];var n=t.apply(this,arguments);return this._super=i,n}}(r,o[r]):o[r];n.prototype=s,n.prototype.constructor=n;for(var o in this)n[o]=this[o];return n},o.Clazz=n}(),o.noop=function(){},o.isFunction=function(o){return"function"==typeof o},o.isObject=function(o){return"object"==typeof o},o.isArray=Array.isArray||function(o){return o instanceof Array},o.extend=function(){var t=[].slice.call(arguments),i=t[0]||{},n=1,e=t.length,s=!1;for("boolean"==typeof i&&(s=i,i=t[n]||{},n++),o.isObject(i)||(i={}),n===e&&(i=this,n--);n<e;n++){var r=t[n];if(r&&o.isObject(r))for(var a in r){var l,p,c=i[a],u=r[a];i!==u&&(s&&u&&(o.isObject(u)||(p=o.isArray(u)))?(p?(p=!1,l=c&&o.isArray(c)?c:[]):l=c&&o.isObject(c)?c:{},i[a]=o.extend(s,l,u)):void 0!==u&&(i[a]=u))}}return i},o.selector=function(o){return"string"==typeof o&&(o=document.querySelector(o)),o},o.parseHtml=function(o){if(null==o||"string"!=typeof o)return null;var t,i=document.createElement("div"),n=document.createDocumentFragment();for(i.innerHTML=o;t=i.firstChild;)n.appendChild(t);return n},o.namespace=function(o,t){var i=window.MiniRefreshTools;if(!o)return i;for(var n=o.split("."),e=n.length,s=0;s<e-1;s++){var r=n[s];i[r]=i[r]||{},i=i[r]}return i[n[e-1]]=t,i[n[e-1]]},"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return o}),o}({}),function(o){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(o){window.setTimeout(o,1e3/60)},i=function(o){this.minirefresh=o,this.container=o.container,this.scrollWrap=o.scrollWrap,this.options=o.options,this.events={},this.isScrollTo=!1,this.upLoading=!1,this.downLoading=!1,this.isLockDown=!1,this.isLockUp=!1,this.isShowUpLoading=!0,this.isFinishUp=!1,!this.options.down&&(this.isLockDown=!0),!this.options.up&&(this.isLockUp=!0),this._initPullDown(),this._initPullUp();var t=this;setTimeout(function(){t.options.down&&t.options.down.auto?t.triggerDownLoading():t.options.up&&t.options.up.auto&&t.triggerUpLoading()})};i.prototype._translate=function(o,t){o=o||0,t=t||0;var i=this.scrollWrap;i.style.webkitTransitionDuration=t+"ms",i.style.transitionDuration=t+"ms",i.style.webkitTransform="translate(0px, "+o+"px) translateZ(0px)",i.style.transform="translate(0px, "+o+"px) translateZ(0px)"},i.prototype._initPullDown=function(){var o=this,t=this.scrollWrap,i=this.options,n=i.down.bounceTime,e=i.down.offset;t.webkitTransitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)",t.transitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)";var s=function(i){o.isScrollTo&&i.preventDefault(),o.startTop=t.scrollTop,o.startY=i.touches?i.touches[0].pageY:i.clientY,o.startX=i.touches?i.touches[0].pageX:i.clientX};t.addEventListener("touchstart",s),t.addEventListener("mousedown",s);var r=function(n){if(void 0!==o.startTop&&o.startTop<=0&&!o.downLoading&&!o.isLockDown){var s=n.touches?n.touches[0].pageY:n.clientY,r=n.touches?n.touches[0].pageX:n.clientX;o.preY||(o.preY=s);var a=s-o.preY;o.preY=s;var l=s-o.startY,p=r-o.startX;if(Math.abs(p)>Math.abs(l))return void n.preventDefault();l>0?(o.isMoveDown=!0,n.preventDefault(),o.downHight||(o.downHight=0),o.downHight<e?o.downHight+=a:a>0?o.downHight+=a*i.down.dampRate:o.downHight+=a,o.events.pull&&o.events.pull(o.downHight,e),o._translate(o.downHight)):t.scrollTop<=0&&(t.scrollTop+=Math.abs(a))}};t.addEventListener("touchmove",r),t.addEventListener("mousemove",r);var a=function(t){o.isMoveDown&&(o.downHight>=e?o.triggerDownLoading():(o._translate(0,n),o.downHight=0),o.isMoveDown=!1),o.startY=0,o.startX=0,o.preY=0,o.startTop=void 0};t.addEventListener("touchend",a),t.addEventListener("mouseup",a),t.addEventListener("mouseleave",a)},i.prototype._initPullUp=function(){var o=this,t=this.scrollWrap,i=this.options;t.addEventListener("scroll",function(){var n=t.scrollTop,e=t.scrollHeight,s=t.clientHeight;if(o.events.scroll&&o.events.scroll(n),!o.upLoading&&!o.isLockUp&&!o.isFinishUp){var r=e-s-n;r<=i.up.offset&&o.triggerUpLoading()}})},i.prototype._loadFull=function(){var o=this,t=this.scrollWrap,i=this.options;setTimeout(function(){!o.isLockUp&&i.up.loadFull.enable&&t.scrollHeight<=t.clientHeight&&o.triggerUpLoading()},i.up.loadFull.delay||0)},i.prototype.triggerDownLoading=function(){var o=this,t=this.options,i=t.down.bounceTime;o.downLoading=!0,o.downHight=t.down.offset,o._translate(o.downHight,i),o.events.downLoading&&o.events.downLoading()},i.prototype.endDownLoading=function(){var o=this,t=this.options,i=t.down.bounceTime;this.downLoading&&(o._translate(0,i),o.downHight=0,o.downLoading=!1)},i.prototype.triggerUpLoading=function(){this.upLoading=!0,this.events.upLoading&&this.events.upLoading()},i.prototype.endUpLoading=function(o){this.options;this.upLoading&&(this.upLoading=!1,o?this.isFinishUp=!0:this._loadFull())},i.prototype.scrollTo=function(o,i){var n=this,e=this.scrollWrap;o=o||0,i=i||0;var s=e.scrollHeight-e.clientHeight;o=Math.max(o,0),o=Math.min(o,s);var r=e.scrollTop-o;if(0!==r){if(0===i)return void(e.scrollTop=o);var a=60*i/1e3,l=r/a,p=0;n.isScrollTo=!0;var c=function(){p<a?(p==a-1?e.scrollTop=o:e.scrollTop-=l,p++,t(c)):n.isScrollTo=!1};t(c)}},i.prototype.lockDown=function(o){this.options.down&&o&&(this.isLockDown=!1)},i.prototype.lockUp=function(o){this.options.up&&o&&(this.isLockUp=!1)},i.prototype.resetUpLoading=function(o){this.isFinishUp&&(this.isFinishUp=!1),"boolean"==typeof o&&(this.isShowUpLoading=o);var t=document.createEvent("HTMLEvents");t.initEvent("scroll",!1),this.scrollWrap.dispatchEvent(t)},i.prototype.on=function(t,i){t&&o.isFunction(i)&&(this.events[t]=i)},i.prototype.off=function(o){this.events[o]=void 0},o.scroll=i}(MiniRefreshTools),function(o){var t={down:{auto:!1,offset:75,dampRate:.2,bounceTime:500,successAnim:{enable:!1,duration:300},callback:o.noop},up:{auto:!0,offset:100,loadFull:{enable:!0,delay:300},callback:o.noop},container:"#minirefresh"},i=o.Clazz.extend({init:function(i){i=o.extend(!0,{},t,i),this.container=o.selector(i.container),this.scrollWrap=this.container.children[0],this.options=i,this.scroller=new o.scroll(this),this._initEvent(),this._initHook&&this._initHook(this.scroller.isLockDown,this.scroller.isLockUp)},_initEvent:function(){var o=this,t=this.options;this.scroller.on("downLoading",function(){o._downLoaingHook&&o._downLoaingHook(),t.down.callback&&t.down.callback()}),this.scroller.on("upLoading",function(){o._upLoaingHook&&o._upLoaingHook(),t.up.callback&&t.up.callback()}),this.scroller.on("pull",function(i,n){o._pullHook&&o._pullHook(i,n),t.down.pull&&t.down.pull()}),this.scroller.on("scroll",function(i){o._scrollHook&&o._scrollHook(i),t.up.scroll&&t.up.scroll()})},_endDownLoading:function(o){var t=this;if(this.options.down&&this.scroller.downLoading){var i=this.options.down.successAnim.enable,n=this.options.down.successAnim.duration;i?this._downLoaingSuccessHook&&this._downLoaingSuccessHook(o):n=0,setTimeout(function(){t.scroller.endDownLoading(),this._downLoaingEndHook&&this._downLoaingEndHook()},n)}},_endUpLoading:function(o){this.scroller.upLoading&&(this.scroller.endUpLoading(o),this._upLoaingEndHook&&this._upLoaingEndHook(o))},endDownLoading:function(o){"boolean"!=typeof o&&(o=!0),this._endDownLoading(o),this.resetUpLoading()},endUpLoading:function(o){this._endUpLoading(o)},resetUpLoading:function(o){this.scroller.resetUpLoading(o)},lockUpLoading:function(o){this.scroller.lockUp(o),this._lockUpLoadingHook&&this._lockUpLoadingHook(o)},lockDownLoading:function(o){this.scroller.lockDown(o),this._lockDownLoadingHook&&this._lockDownLoadingHook(o)},triggerUpLoading:function(){this.scroller.triggerUpLoading()},triggerDownLoading:function(){this.scroller.scrollTo(0),this.scroller.triggerDownLoading()},scrollTo:function(o,t){this.scroller.scrollTo(o,t)}});MiniRefreshTools.core=i}(MiniRefreshTools),function(o){var t={down:{successAnim:{enable:!0,duration:300}},up:{toTop:{enable:!0,duration:300,offset:800},empty:{enable:!0,click:o.noop}}},i=o.core.extend({init:function(i){i=o.extend(!0,{},t,i),this._super(i)},_initHook:function(o,t){var i=this.container,n=this.scrollWrap;i.classList.add("minirefresh-skin-default");var e=document.createElement("div");e.className="minirefresh-downwarp",e.innerHTML='<div class="downwarp-content"><p class="downwarp-progress"></p><p class="downwarp-tip">下拉刷新 </p></div>',i.insertBefore(e,n),this.downwarp=e,this.isCanPullDown=!1;var s=document.createElement("div");s.className="minirefresh-upwarp",s.innerHTML='<p class="upwarp-tip">加载中..</p>',s.style.visibility="hidden",n.appendChild(s),this.upwarp=s,this._initToTop(),this._initEmpty()},_initToTop:function(){var o=this,t=this.options,i=t.up.toTop.enable,n=t.up.toTop.duration;if(i){var e=document.createElement("div");e.className="minirefresh-totop minirefresh-skin-default",e.onclick=function(){o.scroller.scrollTo(0,n)},e.classList.add("minirefresh-fade-out"),this.toTopBtn=e,this.isShowToTopBtn=!1,document.body.appendChild(e)}},_initEmpty:function(){var o=this.options,t=o.up.empty.enable,i=o.up.empty.click;if(t){var n=document.createElement("div");n.className="minirefresh-empty",n.innerHTML='<div class="empty-icon"></div><p class="empty-tip">暂无相关数据~</p><p class="empty-btn">去逛逛&gt;</p>';var e=n.querySelector(".empty-btn");e.onclick=function(o){i&&i()},this.emptyContent=n,this.isEmptyShow=!1}},_pullHook:function(o,t){o<t?this.isCanPullDown&&(this.downwarp.querySelector(".downwarp-tip").innerText="下拉刷新",this.isCanPullDown=!1):this.isCanPullDown||(this.downwarp.querySelector(".downwarp-tip").innerText="释放可以刷新",this.isCanPullDown=!0)},_scrollHook:function(o){var t=this.options,i=t.up.toTop.enable,n=this.toTopBtn;i&&n&&(o>=t.up.toTop.offset?this.isShowToTopBtn||(n.classList.remove("minirefresh-fade-out"),n.classList.add("minirefresh-fade-in"),this.isShowToTopBtn=!0):this.isShowToTopBtn&&(n.classList.add("minirefresh-fade-out"),n.classList.remove("minirefresh-fade-in"),this.isShowToTopBtn=!1))},_downLoaingHook:function(){this.downwarp.querySelector(".downwarp-tip").innerText="刷新中..."},_downLoaingSuccessHook:function(o){this.downwarp.querySelector(".downwarp-tip").innerText="刷新成功"},_downLoaingEndHook:function(){this.downwarp.querySelector(".downwarp-tip").innerText="下拉刷新",this.isCanPullDown=!1},_upLoaingHook:function(){this.upwarp.querySelector(".upwarp-tip").innerText="加载中...",this.upwarp.style.visibility="visible"},_upLoaingEndHook:function(o){o?this.upwarp.querySelector(".upwarp-tip").innerText="没有更多数据了":this.upwarp.style.visibility="hidden"},_lockUpLoadingHook:function(o){},_lockDownLoadingHook:function(o){},showEmpty:function(){var o=this.options,t=o.up.empty.enable,i=this.emptyContent;t&&i&&!this.isEmptyShow&&this.scrollWrap.appendChild(i)},hideEmpty:function(){var o=this.options,t=o.up.empty.enable,i=this.emptyContent;if(t&&i&&this.isEmptyShow){var n=i.parentNode;n&&(n.removeChild(i),this.isEmptyShow=!1)}}});o.namespace("skin.default",i),window.MiniRefresh=i}(MiniRefreshTools);