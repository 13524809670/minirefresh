/**
 * minirefresh - 一款极简的H5下拉刷新
 * @version v1.0.0
 * @author dailc
 * https://github.com/dailc/minirefresh
 */
window.MiniRefreshTools=window.MiniRefreshTools||function(o){return function(){var n=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,i=function(){};i.extend=function(o){function i(){!n&&this.init&&this.init.apply(this,arguments)}var s=this.prototype;n=!0;var e=new this;n=!1;for(var r in o)e[r]="function"==typeof o[r]&&"function"==typeof s[r]&&t.test(o[r])?function(o,n){return function(){var t=this._super;this._super=s[o];var i=n.apply(this,arguments);return this._super=t,i}}(r,o[r]):o[r];i.prototype=e,i.prototype.constructor=i;for(var o in this)i[o]=this[o];return i},o.Clazz=i}(),o.noop=function(){},o.isFunction=function(o){return"function"==typeof o},o.isObject=function(o){return"object"==typeof o},o.isArray=Array.isArray||function(o){return o instanceof Array},o.extend=function(){var n=[].slice.call(arguments),t=n[0]||{},i=1,s=n.length,e=!1;for("boolean"==typeof t&&(e=t,t=n[i]||{},i++),o.isObject(t)||(t={}),i===s&&(t=this,i--);i<s;i++){var r=n[i];if(r&&o.isObject(r))for(var a in r){var p,c,l=t[a],d=r[a];t!==d&&(e&&d&&(o.isObject(d)||(c=o.isArray(d)))?(c?(c=!1,p=l&&o.isArray(l)?l:[]):p=l&&o.isObject(l)?l:{},t[a]=o.extend(e,p,d)):void 0!==d&&(t[a]=d))}}return t},o.selector=function(o){return"string"==typeof o&&(o=document.querySelector(o)),o},o.parseHtml=function(o){if(null==o||"string"!=typeof o)return null;var n,t=document.createElement("div"),i=document.createDocumentFragment();for(t.innerHTML=o;n=t.firstChild;)i.appendChild(n);return i},o.namespace=function(o,n){var t=window.MiniRefreshTools;if(!o)return t;for(var i=o.split("."),s=i.length,e=0;e<s-1;e++){var r=i[e];t[r]=t[r]||{},t=t[r]}return t[i[s-1]]=n,t[i[s-1]]},"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return o}),o}({}),function(o){var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(o){window.setTimeout(o,1e3/60)},t=function(o){this.minirefresh=o,this.container=o.container,this.scrollWrap=o.scrollWrap,this.options=o.options,this.events={},this.isScrollTo=!1,this.upLoading=!1,this.downLoading=!1,this.isLockDown=!1,this.isLockUp=!1,this.isShowUpLoading=!0,this.isFinishUp=!1,!this.options.down&&(this.isLockDown=!0),!this.options.up&&(this.isLockUp=!0),this._initPullDown(),this._initPullUp();var n=this;setTimeout(function(){n.options.down&&n.options.down.auto?n.triggerDownLoading():n.options.up&&n.options.up.auto&&n.triggerUpLoading()})};t.prototype._translate=function(o,n){o=o||0,n=n||0;var t=this.scrollWrap;t.style.webkitTransitionDuration=n+"ms",t.style.transitionDuration=n+"ms",t.style.webkitTransform="translate(0px, "+o+"px) translateZ(0px)",t.style.transform="translate(0px, "+o+"px) translateZ(0px)"},t.prototype._initPullDown=function(){var o=this,n=this.scrollWrap,t=this.options,i=t.down.bounceTime,s=t.down.offset;n.webkitTransitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)",n.transitionTimingFunction="cubic-bezier(0.1, 0.57, 0.1, 1)";var e=function(t){o.isScrollTo&&t.preventDefault(),o.startTop=n.scrollTop,o.startY=t.touches?t.touches[0].pageY:t.clientY,o.startX=t.touches?t.touches[0].pageX:t.clientX};n.addEventListener("touchstart",e),n.addEventListener("mousedown",e);var r=function(i){if(void 0!==o.startTop&&o.startTop<=0&&!o.downLoading&&!o.isLockDown){var e=i.touches?i.touches[0].pageY:i.clientY,r=i.touches?i.touches[0].pageX:i.clientX;o.preY||(o.preY=e);var a=e-o.preY;o.preY=e;var p=e-o.startY,c=r-o.startX;if(Math.abs(c)>Math.abs(p))return void i.preventDefault();p>0?(o.isMoveDown=!0,i.preventDefault(),o.downHight||(o.downHight=0),o.downHight<s?o.downHight+=a:a>0?o.downHight+=a*t.down.dampRate:o.downHight+=a,o.events.pull&&o.events.pull(o.downHight,s),o._translate(o.downHight)):n.scrollTop<=0&&(n.scrollTop+=Math.abs(a))}};n.addEventListener("touchmove",r),n.addEventListener("mousemove",r);var a=function(n){o.isMoveDown&&(o.downHight>=s?o.triggerDownLoading():(o._translate(0,i),o.downHight=0),o.isMoveDown=!1),o.startY=0,o.startX=0,o.preY=0,o.startTop=void 0};n.addEventListener("touchend",a),n.addEventListener("mouseup",a),n.addEventListener("mouseleave",a)},t.prototype._initPullUp=function(){var o=this,n=this.scrollWrap,t=this.options;n.addEventListener("scroll",function(){var i=n.scrollTop,s=n.scrollHeight,e=n.clientHeight;if(o.events.scroll&&o.events.scroll(i),!o.upLoading&&!o.isLockUp&&!o.isFinishUp){var r=s-e-i;r<=t.up.offset&&o.triggerUpLoading()}})},t.prototype._loadFull=function(){var o=this,n=this.scrollWrap,t=this.options;setTimeout(function(){!o.isLockUp&&t.up.loadFull.enable&&n.scrollHeight<=n.clientHeight&&o.triggerUpLoading()},t.up.loadFull.delay||0)},t.prototype.triggerDownLoading=function(){var o=this,n=this.options,t=n.down.bounceTime;o.downLoading=!0,o.downHight=n.down.offset,o._translate(o.downHight,t),o.events.downLoading&&o.events.downLoading()},t.prototype.endDownLoading=function(){var o=this,n=this.options,t=n.down.bounceTime;this.downLoading&&(o._translate(0,t),o.downHight=0,o.downLoading=!1)},t.prototype.triggerUpLoading=function(){this.upLoading=!0,this.events.upLoading&&this.events.upLoading()},t.prototype.endUpLoading=function(o){this.options;this.upLoading&&(this.upLoading=!1,o?this.isFinishUp=!0:this._loadFull())},t.prototype.scrollTo=function(o,t){var i=this,s=this.scrollWrap;o=o||0,t=t||0;var e=s.scrollHeight-s.clientHeight;o=Math.max(o,0),o=Math.min(o,e);var r=s.scrollTop-o;if(0!==r){if(0===t)return void(s.scrollTop=o);var a=60*t/1e3,p=r/a,c=0;i.isScrollTo=!0;var l=function(){c<a?(c==a-1?s.scrollTop=o:s.scrollTop-=p,c++,n(l)):i.isScrollTo=!1};n(l)}},t.prototype.lockDown=function(o){this.options.down&&o&&(this.isLockDown=!1)},t.prototype.lockUp=function(o){this.options.up&&o&&(this.isLockUp=!1)},t.prototype.resetUpLoading=function(o){this.isFinishUp&&(this.isFinishUp=!1),"boolean"==typeof o&&(this.isShowUpLoading=o);var n=document.createEvent("HTMLEvents");n.initEvent("scroll",!1),this.scrollWrap.dispatchEvent(n)},t.prototype.on=function(n,t){n&&o.isFunction(t)&&(this.events[n]=t)},t.prototype.off=function(o){this.events[o]=void 0},o.scroll=t}(MiniRefreshTools),function(o){var n={down:{auto:!1,offset:75,dampRate:.2,bounceTime:300,successAnim:{enable:!1,duration:300},callback:o.noop},up:{auto:!0,offset:100,loadFull:{enable:!0,delay:300},callback:o.noop},container:"#minirefresh"},t=o.Clazz.extend({init:function(t){t=o.extend(!0,{},n,t),this.container=o.selector(t.container),this.scrollWrap=this.container.children[0],this.options=t,this.scroller=new o.scroll(this),this._initEvent(),this._initHook&&this._initHook(this.scroller.isLockDown,this.scroller.isLockUp)},_initEvent:function(){var o=this,n=this.options;this.scroller.on("downLoading",function(){o._downLoaingHook&&o._downLoaingHook(),n.down.callback&&n.down.callback()}),this.scroller.on("upLoading",function(){o._upLoaingHook&&o._upLoaingHook(),n.up.callback&&n.up.callback()}),this.scroller.on("pull",function(t,i){o._pullHook&&o._pullHook(t,i),n.down.pull&&n.down.pull()}),this.scroller.on("scroll",function(t){o._scrollHook&&o._scrollHook(t),n.up.scroll&&n.up.scroll()})},_endDownLoading:function(o){var n=this;if(this.options.down&&this.scroller.downLoading){var t=this.options.down.successAnim.enable,i=this.options.down.successAnim.duration;t?this._downLoaingSuccessHook&&this._downLoaingSuccessHook(o):i=0,setTimeout(function(){n.scroller.endDownLoading(),n._downLoaingEndHook&&n._downLoaingEndHook(o)},i)}},_endUpLoading:function(o){this.scroller.upLoading&&(this.scroller.endUpLoading(o),this._upLoaingEndHook&&this._upLoaingEndHook(o))},endDownLoading:function(o){"boolean"!=typeof o&&(o=!0),this._endDownLoading(o),this.resetUpLoading()},endUpLoading:function(o){this._endUpLoading(o)},resetUpLoading:function(o){this.scroller.resetUpLoading(o)},lockUpLoading:function(o){this.scroller.lockUp(o),this._lockUpLoadingHook&&this._lockUpLoadingHook(o)},lockDownLoading:function(o){this.scroller.lockDown(o),this._lockDownLoadingHook&&this._lockDownLoadingHook(o)},triggerUpLoading:function(){this.scroller.triggerUpLoading()},triggerDownLoading:function(){this.scroller.scrollTo(0),this.scroller.triggerDownLoading()},scrollTo:function(o,n){this.scroller.scrollTo(o,n)}});MiniRefreshTools.core=t}(MiniRefreshTools),function(o){var n="minirefresh-skin-default",t="minirefresh-downwrap",i="minirefresh-upwrap",s="minirefresh-fade-in",e="minirefresh-fade-out",r="minirefresh-totop",a="minirefresh-rotate",p="minirefresh-hardware-speedup",c="minirefresh-hidden",l="downwrap-success",d="downwrap-error",u={down:{successAnim:{enable:!0,duration:300},contentdown:"下拉刷新",contentover:"释放刷新",contentrefresh:"加载中...",contentsuccess:"刷新成功",contenterror:"刷新失败"},up:{toTop:{enable:!0,duration:300,offset:800},contentdown:"上拉显示更多",contentrefresh:"加载中...",contentnomore:"没有更多数据了"}},h=o.core.extend({init:function(n){n=o.extend(!0,{},u,n),this._super(n)},_initHook:function(o,s){var e=this.container,r=this.scrollWrap,a=this.options;e.classList.add(n),r.classList.add(p);var c=document.createElement("div");c.className=t+" "+p,c.innerHTML='<div class="downwrap-content"><p class="downwrap-progress"></p><p class="downwrap-tips">'+a.down.contentdown+" </p></div>",e.insertBefore(c,r),this.downWrap=c,this.downWrapProgress=this.downWrap.querySelector(".downwrap-progress"),this.downWrapTips=this.downWrap.querySelector(".downwrap-tips"),this.isCanPullDown=!1;var l=document.createElement("div");l.className=i+" "+p,l.innerHTML='<p class="upwrap-progress"></p><p class="upwrap-tips">'+a.up.contentdown+"</p>",l.style.visibility="hidden",r.appendChild(l),this.upWrap=l,this.upWrapProgress=this.upWrap.querySelector(".upwrap-progress"),this.upWrapTips=this.upWrap.querySelector(".upwrap-tips"),this._initToTop()},_initToTop:function(){var o=this,t=this.options,i=t.up.toTop.enable,s=t.up.toTop.duration;if(i){var e=document.createElement("div");e.className=r+" "+n,e.onclick=function(){o.scroller.scrollTo(0,s)},e.classList.add(c),this.toTopBtn=e,this.isShowToTopBtn=!1,document.body.appendChild(e)}},_pullHook:function(o,n){var t=this.options;o<n?this.isCanPullDown&&(this.downWrapTips.innerText=t.down.contentdown,this.isCanPullDown=!1):this.isCanPullDown||(this.downWrapTips.innerText=t.down.contentover,this.isCanPullDown=!0);var i=o/n,s=360*i;this.downWrapProgress.style.webkitTransform="rotate("+s+"deg)",this.downWrapProgress.style.transform="rotate("+s+"deg)"},_scrollHook:function(o){var n=this.options,t=n.up.toTop.enable,i=this.toTopBtn;t&&i&&(o>=n.up.toTop.offset?this.isShowToTopBtn||(i.classList.remove(e),i.classList.remove(c),i.classList.add(s),this.isShowToTopBtn=!0):this.isShowToTopBtn&&(i.classList.add(e),i.classList.remove(s),this.isShowToTopBtn=!1))},_downLoaingHook:function(){this.downWrapTips.innerText=this.options.down.contentrefresh,this.downWrapProgress.classList.add(a)},_downLoaingSuccessHook:function(o){this.downWrapTips.innerText=o?this.options.down.contentsuccess:this.options.down.contenterror,this.downWrapProgress.classList.remove(a),this.downWrapProgress.classList.add(e),this.downWrapProgress.classList.add(o?l:d)},_downLoaingEndHook:function(o){this.downWrapTips.innerText=this.options.down.contentdown,this.downWrapProgress.classList.remove(a),this.downWrapProgress.classList.remove(e),this.downWrapProgress.classList.remove(o?l:d),this.isCanPullDown=!1},_upLoaingHook:function(){this.upWrapTips.innerText=this.options.up.contentrefresh,this.upWrapProgress.classList.add(a),this.upWrapProgress.classList.remove(c),this.upWrap.style.visibility="visible"},_upLoaingEndHook:function(o){o?this.upWrapTips.innerText=this.options.up.contentnomore:(this.upWrap.style.visibility="hidden",this.upWrapTips.innerText=this.options.up.contentdown),this.upWrapProgress.classList.remove(a),this.upWrapProgress.classList.add(c)},_lockUpLoadingHook:function(o){},_lockDownLoadingHook:function(o){}});o.namespace("skin.default",h),window.MiniRefresh=h}(MiniRefreshTools);