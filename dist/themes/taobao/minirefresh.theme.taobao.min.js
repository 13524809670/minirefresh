/**
 * minirefresh - 一款极简的H5下拉刷新，内测版本
 * @version v0.0.3
 * @author dailc(dailichun@aliyun.com)
 * https://github.com/minirefresh/minirefresh
 */
!function(t){var s="minirefresh-theme-taobao",n="minirefresh-downwrap",o="minirefresh-hardware-speedup",e="minirefresh-rotate",r="minirefresh-hidden",i=0,a=1,d=2,p=800,h="secret-garden-bg-in",w="secret-garden-bg-out",c="secret-garden-moon-in",l="secret-garden-moon-out",f={down:{offset:100,dampRate:.4,successAnim:{isEnable:!1},secretGarden:{isEnable:!0,offset:200,tips:"欢迎光临秘密花园",inSecretGarden:t.noop}}},W=t.theme.defaults.extend({init:function(s){s=t.extend(!0,{},f,s),this._super(s)},_initDownWrap:function(){var t=this.container,e=this.scrollWrap,r=this.options,a=document.createElement("div");a.className=n+" "+o,a.innerHTML='<div class="downwrap-bg"></div><div class="downwrap-moon"></div><div class="downwrap-content"><p class="downwrap-progress"></p><p class="downwrap-tips">'+r.down.contentdown+"</p></div>",t.insertBefore(a,e),t.classList.add(s),this.downWrap=a,this.downWrapProgress=this.downWrap.querySelector(".downwrap-progress"),this.downWrapTips=this.downWrap.querySelector(".downwrap-tips"),this.downWrapBg=this.downWrap.querySelector(".downwrap-bg"),this.downWrapMoon=this.downWrap.querySelector(".downwrap-moon"),this.pullState=i,this.downWrapHeight=this.downWrap.offsetHeight||p,this._transformDownWrap(-1*this.downWrapHeight)},_transformDownWrap:function(t,s){t=t||0,s=s||0,this.downWrap.style.webkitTransitionDuration=s+"ms",this.downWrap.style.transitionDuration=s+"ms",this.downWrap.style.webkitTransform="translateY("+t+"px)  translateZ(0px)",this.downWrap.style.transform="translateY("+t+"px)  translateZ(0px)"},_rotateDownProgress:function(t){this.downWrapProgress.style.webkitTransform="rotate("+t+"deg)",this.downWrapProgress.style.transform="rotate("+t+"deg)"},_pullHook:function(t,s){var n=this.options,o=n.down,e=o.secretGarden.isEnable,p=o.secretGarden.offset,h=360,w=t/s,c=h*w;this._transformDownWrap(-this.downWrapHeight+t),this._rotateDownProgress(c),t<s?this.pullState!==i&&(this.downWrapTips.classList.remove(r),this.downWrapProgress.classList.remove(r),this.downWrapTips.innerText=o.contentdown,this.pullState=i):t>=s&&(!e||t<p)?this.pullState!==a&&(this.downWrapTips.classList.remove(r),this.downWrapProgress.classList.remove(r),this.downWrapTips.innerText=o.contentover,this.pullState=a):this.pullState!==d&&(this.downWrapTips.classList.remove(r),this.downWrapProgress.classList.add(r),this.downWrapTips.innerText=o.secretGarden.tips,this.pullState=d)},_beforeDownLoadingHook:function(t,s){return this.pullState!==d||(this._inSecretGarden(),!1)},_downLoaingHook:function(){this.downWrapTips.innerText=this.options.down.contentrefresh,this.downWrapProgress.classList.add(e),this._transformDownWrap(-this.downWrapHeight+this.options.down.offset,this.options.down.bounceTime)},_downLoaingSuccessHook:function(){},_downLoaingEndHook:function(t){this.downWrapTips.innerText=this.options.down.contentdown,this.downWrapProgress.classList.remove(e),this._transformDownWrap(-this.downWrapHeight,this.options.down.bounceTime),this.pullState=i},_cancelLoaingHook:function(){this._transformDownWrap(-this.downWrapHeight,this.options.down.bounceTime)},_secretGardenAnimation:function(t){var s=t?h:w,n=t?w:h,o=t?c:l,e=t?l:c;this.downWrapBg.classList.remove(n),this.downWrapBg.classList.add(s),this.downWrapMoon.classList.remove(e),this.downWrapMoon.classList.add(o)},_inSecretGarden:function(){var t=this.options.down.bounceTime,s=this.options.down.secretGarden.inSecretGarden;this.downWrapTips.classList.add(r),this.scroller.translateScrollWrap(this.scrollWrap.clientHeight,t),this._transformDownWrap(this.scrollWrap.clientHeight-this.downWrapHeight,t),this._secretGardenAnimation(!0),s&&s()},resetSecretGarden:function(){var t=this.options.down.bounceTime;this.scroller.translateScrollWrap(0,t),this._transformDownWrap(-1*this.downWrapHeight,t),this._secretGardenAnimation(!1)}});t.namespace("theme.taobao",W),window.MiniRefresh=W,"undefined"!=typeof module&&module.exports?module.exports=W:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return W})}(MiniRefreshTools);